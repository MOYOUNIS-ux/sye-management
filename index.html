<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SYE Management</title>
<style>
body{font-family:Arial,sans-serif;background:#f9f9f9;color:#333;margin:0;padding:0;}
header{background:#4A90E2;color:#fff;padding:20px;text-align:center;font-size:24px;font-weight:bold;display:flex;align-items:center;justify-content:center;}
header img{height:50px;margin-right:10px;}
nav{display:flex;justify-content:center;background:#e6f0ff;}
nav button{background:#4A90E2;color:#fff;border:none;padding:10px 20px;margin:5px;cursor:pointer;border-radius:5px;transition:0.3s;}
nav button:hover{background:#357ABD;}
.container{padding:20px;}
.tab{display:none;}
label{display:block;margin:8px 0;font-weight:bold;}
input, select{padding:6px;width:100%;margin-bottom:10px;border:1px solid #ccc;border-radius:4px;}
button.action{background:#28a745;margin-top:10px;}
button.action:hover{background:#218838;}
.table-wrapper{overflow-x:auto;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
table, th, td{border:1px solid #ccc;}
th, td{padding:8px;text-align:center;}
.footer{text-align:center;margin-top:30px;color:#999;font-size:14px;}
</style>
</head>
<body>
<header>
<img src="https://syecommunity.com/wp-content/uploads/2020/12/SYE-Logo.png" alt="SYE Logo">
SYE Management
</header>
<nav>
<button onclick="showTab('sales')">المبيعات</button>
<button onclick="showTab('expenses')">المصروفات</button>
</nav>

<div class="container">

<!-- صفحة المبيعات -->
<div id="sales" class="tab">
  <h2>فاتورة المبيعات</h2>
  <label>اسم العميل:</label>
  <input type="text" id="customer">
  <label>رقم الهاتف:</label>
  <input type="text" id="phone">

  <label>الخدمات:</label>
  <select id="services" multiple size="10">
    <option>Programs</option>
    <option>Conversation Program</option>
    <option>Teens Program</option>
    <option>Kids Program</option>
    <option>Native Program</option>
    <option>Speaking Club (adults)</option>
    <option>Speaking Club (kids)</option>
    <option>Business English</option>
    <option>Business Writing</option>
    <option>IELTS preparation</option>
    <option>Placement test</option>
    <option>Delay fees</option>
    <option>SYE’s Certificate</option>
    <option>Re-oral test</option>
    <option>Re-do level</option>
    <option>Late Exam</option>
    <option>Versant Certificate</option>
    <option>Make up session</option>
    <option>Mock Exam</option>
    <option>Practice Area</option>
  </select>

  <label>الكتب:</label>
  <select id="books" multiple size="6">
    <option>Level 1</option>
    <option>Level 2</option>
    <option>Level 3</option>
    <option>Level 4</option>
    <option>Level 5</option>
    <option>Level 6</option>
  </select>

  <label>السعر الإجمالي:</label>
  <input type="number" id="total" value="0">
  <label>المدفوع:</label>
  <input type="number" id="paid" value="0">
  <label>المستحق تلقائي:</label>
  <input type="number" id="due" value="0" readonly>
  <label>ملاحظات:</label>
  <input type="text" id="notes">

  <button class="action" onclick="saveInvoice()">حفظ الفاتورة</button>
</div>

<!-- صفحة المصروفات -->
<div id="expenses" class="tab">
  <h2>تسجيل المصروفات</h2>
  <label>البند:</label>
  <select id="expenseCategory">
    <option>غاز</option>
    <option>كهرباء</option>
    <option>مياه</option>
    <option>إكراميات</option>
    <option>انتقالات كتب</option>
    <option>انتقالات موظفين</option>
    <option>مشتريات بوفية</option>
  </select>
  <label>التفاصيل:</label>
  <input type="text" id="expenseDetail">
  <label>المبلغ:</label>
  <input type="number" id="expenseAmount" value="0">
  <label>ملاحظات:</label>
  <input type="text" id="expenseNotes">
  <button class="action" onclick="saveExpense()">حفظ المصروف</button>
</div>

</div>

<div class="footer">Designed by Mohamed Younis</div>

<script>
// تبديل الصفحات
function showTab(tabId){
  document.querySelectorAll('.tab').forEach(t=>t.style.display='none');
  document.getElementById(tabId).style.display='block';
}
showTab('sales'); // الصفحة الافتراضية

// حساب المستحق تلقائي
document.getElementById('paid').addEventListener('input',()=>{
  const total = parseFloat(document.getElementById('total').value)||0;
  const paid = parseFloat(document.getElementById('paid').value)||0;
  document.getElementById('due').value = Math.max(0,total-paid);
});

// رابط سكربت Google Apps Script
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzC8lMFS1RJPk0ab21s-SqtmlzZtbqzE-ABN41hqbJqiUWjfg-wBX5zhR4Z5XDDVVFv/exec";

// حفظ الفاتورة
function saveInvoice(){
  const customer = document.getElementById('customer').value;
  const phone = document.getElementById('phone').value;
  const services = Array.from(document.getElementById('services').selectedOptions).map(o=>o.value);
  const books = Array.from(document.getElementById('books').selectedOptions).map(o=>o.value);
  const total = parseFloat(document.getElementById('total').value)||0;
  const paid = parseFloat(document.getElementById('paid').value)||0;
  const due = parseFloat(document.getElementById('due').value)||0;
  const notes = document.getElementById('notes').value;

  const payload = {
    sheet:"Sales",
    customer, phone,
    items: services.concat(books),
    total, paid, due, notes
  };

  fetch(SCRIPT_URL,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify(payload)
  })
  .then(res=>res.text())
  .then(txt=>alert(txt))
  .catch(err=>alert('خطأ في الاتصال: '+err));
}

// حفظ المصروف
function saveExpense(){
  const category = document.getElementById('expenseCategory').value;
  const detail = document.getElementById('expenseDetail').value;
  const amount = parseFloat(document.getElementById('expenseAmount').value)||0;
  const notes = document.getElementById('expenseNotes').value;

  const payload = { sheet:"Expenses", category, detail, amount, notes };

  fetch(SCRIPT_URL,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify(payload)
  })
  .then(res=>res.text())
  .then(txt=>alert(txt))
  .catch(err=>alert('خطأ في الاتصال: '+err));
}
</script>
</body>
</html>
